import ast
def trip_point_make(place_ID: str, period: str, ETL_dataframe):
    '''
    ```
    Args:
        place_ID : 單個 place_ID
        period : lunch|dinner|morning|afternoon|night 
        ETL_dataframe : ETL csv dataframe
    return :
        point : 給 旅遊推薦端 的單個point格式
    ```
    ---
    - point =

        ```    
        {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            place_id : "str",
            name : “店名1”,
            rating : float,
            lat : float,
            lon : float,
            label_type : str,                # 大分類
            label : str,                     # 小分類
            hours : { },
            period: lunch|dinner|morning|afternoon|night 
            url : ''         # googlemap url 
        }
        ```
    '''
    filter_series = ETL_dataframe.loc[place_ID]
    point = {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
                'place_id' : place_ID,
                'name' : filter_series['place_name'],
                'rating' : float(filter_series['rating']),
                'lat' : float(filter_series['lat']),
                'lon' : float(filter_series['lon']),
                'label_type' : filter_series['new_label_type'],                # 大分類
                'label' : filter_series['label'],                              # 小分類
                'hours' : ast.literal_eval(filter_series['hours']),
                'period': period, 
                'url' : filter_series['location_url']         # googlemap url 
            }
    return point
    
if __name__ == '__main__':
    from feature.sql_csv.core.data_pipeline.utils.ETL_dataframe_generate import ETL_dataframe_generate
    from pprint import pprint

    ETL_dataframe = ETL_dataframe_generate()
    place_ID = 'ChIJqelWmSGnQjQR0oQv0a6ZJ8o'  # 康小玲      ['外帶外送', '其他支付']
    period = 'morning'

    point = trip_point_make(
                place_ID=place_ID,
                period=period,
                ETL_dataframe=ETL_dataframe,
            )
    
    pprint(point, sort_dicts=False)